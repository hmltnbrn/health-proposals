<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Commonwealth Fund - Healthcare Plans</title>
  <style type="text/css">

    @font-face {
      font-family: InterfaceRegular;
      src: url('fonts/interface/InterFace_Rg.ttf');
    }

    @font-face {
      font-family: InterfaceBold;
      src: url('fonts/interface/InterFace_Bd.ttf');
    }

    @font-face {
      font-family: BerlingskeSerifTextExtrabold;
      src: url('fonts/berlingske/BerlingskeSerifText-Extrabold.otf');
    }

    * {
      box-sizing: border-box;
      -moz-box-sizing: border-box;
      -webkit-box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: InterfaceRegular;
    }

    p {
      margin: 0;
    }

    h2 {
      margin: 0;
    }

    .body-container {
      width: 100%;
      margin: 0 auto;
      max-width: 900px;
    }

    .top-text {
      padding: 20px 0;
      color: #a3a5a9;
    }

    h1 {
      color: #f47a21;
      margin: 0 0 10px 0;
    }

    .one-color {
      color: #49bdbb;
      fill: #49bdbb;
    }

    .two-color {
      color: #4b92bc;
      fill: #4b92bc;
    }

    .three-color {
      color: #034e7f;
      fill: #034e7f;
    }

    .plan-container {
      display: flex;
      flex-direction: column;
    }

    .big-block-container {
      display: flex;
      height: 75px;
      width: 100%;
      background: linear-gradient(to right, #2d8896, #033865);
    }

    .big-block {
      border: 1px solid white;
      padding: 15px 10px;
      display: flex;
      align-items: flex-end;
    }

    .big-block:first-child {
      border-left: none;
    }

    .big-block:last-child {
      border-right: none;
    }

    .big-block h2 {
      margin: 0;
      font-size: 15px;
      color: white;
    }

    .big-block.one {
      width: calc(100%/6*3);
    }

    .big-block.two {
      width: calc(100%/6*2);
    }

    .big-block.three {
      width: calc(100%/6);
    }

    .small-block-container {
      display: flex;
      height: 85px;
      width: 100%;
      background: linear-gradient(to right, #6ac3c6, #377098);
    }

    .small-block {
      width: calc(100%/6);
      border: 1px solid white;
      padding: 10px;
      display: flex;
      align-items: flex-end;
    }

    .small-block:first-child {
      border-left: none;
    }

    .small-block:last-child {
      border-right: none;
    }

    .small-block h3 {
      margin: 0;
      font-size: 13px;
      color: white;
      font-weight: 500;
    }

    .outline {
      outline: 1px solid white;
    }

    .plan {
      width: 33.3%;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .plan:first-child {
      margin-right: 0.1%;
      align-items: flex-start;
    }

    .plan:last-child {
      margin-left: 0.1%;
      align-items: flex-end;
    }

    .plan h2 {
      font-size: 15px;
      margin-bottom: 5px;
    }

    .plan-main {
      min-height: 100px;
      max-height: 100px;
      width: 100%;
    }

    .plan-main.one {
      background-color: #d7ecee;
    }

    .plan-main.two {
      background-color: #d7ecee;
    }

    .plan-main.three {
      background-color: #d7ecee;
    }

    .plan-description {
      padding: 5px 10px 0 10px;
    }

    .plan-description p {
      font-size: 14px;
      margin-bottom: 10px;
    }

    .timeline-container {
      min-height: 100px;
    }

    div.tooltip {
      font-family: InterfaceRegular;
      position: absolute;
      padding: 10px;
      font-size: 13px;
      background: #eef8f9;
      border: 0px;
      border-radius: 0px;
      pointer-events: none;
      max-width: 150px;
    }

    .tooltip-name {
      color: #656c71;
      font-size: 18px;
    }

    .select-proposal-container {
      color: #a3a5a9;
      font-size: 25px;
      text-align: center;
    }

  </style>
</head>
<body>
  <div class="body-container">
    <div class="top-text">
      <h1>Where Do Federal Health Proposals Fall in the Coverage Continuum</h1>
      <p>As we head into the 2020 presidential election, here is a continuum of health care proposals, from those that aim to offer universal coverage with little or no cost to consumers and a larger federal role to proposals calling for less-regulated private health plans with lower premiums but greater cost sharing and larger role for states.</p>
    </div>
    <div class="plan-container">
      <div class="big-block-container">
        <div class="big-block one">
          <h2>Building on Current Law</h2>
        </div>
        <div class="big-block two">
          <h2>Public Program Buy-Ins</h2>
        </div>
        <div class="big-block three">
          <h2>Single Payer for All Americans</h2>
        </div>
      </div>
      <div class="small-block-container">
        <div class="small-block one">
          <h3>Enhanced subsidied</h3>
        </div>
        <div class="small-block two">
          <h3>Marketplace Medicare-Like Plan</h3>
        </div>
        <div class="small-block three">
          <h3>Medicare-Like Public Plan Available to People with Employer Coverage</h3>
        </div>
        <div class="small-block four">
          <h3>Medicaid Buy-In</h3>
        </div>
        <div class="small-block five">
          <h3>Medicare Buy-In for Americans Over 50</h3>
        </div>
        <div class="small-block six">
          <h3>Medicare for All</h3>
        </div>
      </div>
    </div>
    <div id="timeline-container" class="timeline-container">
    </div>
    <div class="select-proposal-container">
      <p>Select a proposal on the continuum to learn more and compare.</p>
    </div>
  </div>
  <script src="https://d3js.org/d3.v3.min.js"></script>
  <script src="https://d3js.org/queue.v1.min.js"></script>
  <script type="text/javascript">

    queue()
      .defer(d3.json, 'data/plans.json')
      .defer(d3.json, 'data/proposals.json')
      .await(renderAll);
    
    function renderAll(error, plans, proposals) {

      var chartDiv = document.getElementById("timeline-container");
      var w = chartDiv.clientWidth,
          h = chartDiv.clientHeight,
          margin = { top: 20, right: 0, bottom: 20, left: 0 },
          radius = 7;

      var svg = d3.select(".timeline-container").append("svg").attr({
        width: w,
        height: h,
        transform: "translate(" + [0, -1*margin.top] + ")",
      });

      var div = d3.select("body")
        .append("div")
        .attr("class", "tooltip")
        .style("opacity", 0);

      var xScale = d3.scale.linear()
        .domain([0, 100])
        .range([margin.left, w - margin.right]);

      var xAxis = d3.svg.axis()
        .scale(xScale)
        .orient("top")
        .ticks(0)
        .outerTickSize([3.5]);

      var colorLine = d3.scale.linear()
        .domain([0, 100])
        .range(['#4abdbc', '#054d7f'])
        .interpolate(d3.interpolateHcl);

      var defs = svg.append("defs");

      var gradient = defs.append("linearGradient")
        .attr("id", "svgGradient")
        .attr("x1", "0%")
        .attr("x2", "100%");

      gradient.append("stop")
        .attr('class', 'start')
        .attr("offset", "0%")
        .attr("stop-color", "#4abdbc")
        .attr("stop-opacity", 1);

      gradient.append("stop")
        .attr('class', 'end')
        .attr("offset", "100%")
        .attr("stop-color", "#054d7f")
        .attr("stop-opacity", 1);

      svg.append("g").attr({
        "class": "axis",
        "stroke": "white",
        "transform": "translate(" + [0, margin.top] + ")",
        "fill": "none",
        "stroke-width": "9px"
      }).call(xAxis);

      svg.append("g").attr({
        "class": "axis",
        "stroke": "url(#svgGradient)",
        "transform": "translate(" + [0, margin.top] + ")",
        "fill": "none",
        "stroke-width": "7px"
      }).call(xAxis);

      var proposalsLength = proposals.length;

      var circleAttrs = {
        cx: function(d) { return xScale((d.x * 100 / proposalsLength) + 2); },
        cy: 20,
        r: radius,
        stroke: "white",
        "stroke-width": "1px",
        fill: function(d) {
          return colorLine((d.x * 100 / proposalsLength) + 2);
        }
      };

      svg.selectAll("circle")
        .data(proposals)
        .enter()
        .append("circle")
        .attr(circleAttrs)
        .on("mouseover", function(d) {
          div.transition()
            .style("opacity", 1);
          div.html(`<h2 class="tooltip-name">${d.name}</h2>`)
            .style("left", (d3.event.pageX - 20) + "px")
            .style("top", (d3.event.pageY + 20) + "px");
        })
        .on("mouseout", function(d) {
          div.transition()
            .style("opacity", 0);
        });

    }

  </script>
</body>
</html>
